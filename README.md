# HYPERLIQUID TRADING CLI

## Обзор продукта

Hyperliquid Trading CLI — это мощный интерфейс командной строки для автоматизации торговли на бирже Hyperliquid. Этот инструмент позволяет трейдерам и разработчикам взаимодействовать с API Hyperliquid и выполнять полный спектр торговых операций через простые команды терминала.

### Ключевые преимущества

- **Комплексный функционал торговли**: открытие и закрытие позиций, модификация параметров, управление рисками.
- **Гибкое частичное закрытие позиций**: закрытие точного процента (25%, 50%, 75%) существующих позиций.
- **Детальная аналитика**: отслеживание статистики счета, истории сделок, рыночных данных.
- **Автоматизация**: возможность интеграции в торговые скрипты и алгоритмические стратегии.
- **Поддержка Mainnet и Testnet**: работа как с основной, так и с тестовой сетью Hyperliquid.

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/your-username/hyperliquid-trading-cli.git
cd hyperliquid-trading-cli
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Настройте конфигурационный файл:
```bash
mkdir -p data
touch data/bot_testnet.json
```

4. Заполните файл конфигурации (`data/bot_testnet.json`):
```json
{
    "name": "Bot Testnet",
    "private_key": "ваш_приватный_ключ",
    "wallet_address": "ваш_адрес_кошелька",
    "network": "testnet",
    "default_leverage": 5,
    "default_stop_loss_percent": 10,
    "default_take_profit_percent": 20
}
```

## Команды и примеры использования

### Параметры командной строки

| Параметр | Сокращение | Описание | Пример |
|----------|------------|----------|--------|
| `--bot` | `-b` | Имя конфигурационного файла бота (обязательный) | `-b bot_testnet` |
| `--operation` | `-type` | Тип операции (обязательный) | `-type open` |
| `--pair` | `-p` | Торговый актив | `-p BTC` |
| `--amount` | `-a` | Размер ордера в USD | `-a 100` |
| `--leverage` | `-l` | Плечо (кредитное плечо) | `-l 5` |
| `--stop` | `-s` | Стоп-лосс цена | `-s 80000` |
| `--take_profit` | `-t` | Тейк-профит цена | `-t 95000` |
| `--json` | `-j` | Вывод в формате JSON | `-j` |
| `--direction` | `-d` | Направление торговли (`long` или `short`, по умолчанию `long`) | `-d short` |
| `--limit` | `-limit` | Лимит записей для истории (по умолчанию 10) | `-limit 20` |

### Основные торговые операции

#### Открытие позиции

```bash
python main.py -b bot_testnet -type open -p ETH -a 1000 -l 5 -d long -s 2000 -t 2100
```

**Пример вывода:**
```
Ищу файл конфигурации по пути: C:\Users\Administrator\Desktop\crypro\hyper\data\bot_testnet.json
Позиция открыта: {'asset': 'ETH', 'size': 0.4891, 'price': 2044.55, 'leverage': 5.0, 'direction': 'long', 'stop_loss_id': 27070021617, 'take_profit_id': 27070022079, 'amount_usd': 1000.0}
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`open`)
- `-p` / `--pair`: Торговый актив (например, ETH, BTC)
- `-a` / `--amount`: Размер ордера в USD
- `-l` / `--leverage`: Плечо (кредитное плечо)
- `-d` / `--direction`: Направление позиции (`long` или `short`)
- `-s` / `--stop`: Цена стоп-лосс (опционально)
- `-t` / `--take_profit`: Цена тейк-профит (опционально)

#### Закрытие позиции

```bash
python main.py -b bot_testnet -type close -p ETH
```

**Пример вывода:**
```
Ищу файл конфигурации по пути: C:\Users\Administrator\Desktop\crypro\hyper\data\bot_testnet.json
Позиция закрыта: {'status': 'closed', 'asset': 'ETH', 'closed_size': 0.4891}
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`close`)
- `-p` / `--pair`: Торговый актив

#### Немедленное закрытие позиции по рыночной цене

```bash
python main.py -b bot_testnet -type market_close -p BTC
```

**Пример вывода:**
```
Ищу файл конфигурации по пути: C:\Users\Administrator\Desktop\crypro\hyper\data\bot_testnet.json
Позиция немедленно закрыта по рынку: {'status': 'closed', 'asset': 'BTC', 'closed_size': 0.0006, 'order_id': 27070009795}
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`market_close`)
- `-p` / `--pair`: Торговый актив

### Информационные команды

#### Проверка статистики аккаунта

```bash
python main.py -b bot_testnet -type check_stats
```

**Пример вывода:**
```
=== Статистика аккаунта ===
Баланс: 580.35 USD
Доступный баланс: 580.35 USD
Используемая маржа: 0.00 USD
Общая стоимость позиций: 0.00 USD
Общий P&L: 0.00 USD

=== Открытые позиции ===
Нет открытых позиций

=== Текущие котировки ===
BTC: $87696.0000 (Бид: $87684.0000, Аск: $87708.0000)
ETH: $2043.8000 (Бид: $2036.4000, Аск: $2051.2000)
SOL: $139.1750 (Бид: $139.1300, Аск: $139.2200)
AVAX: $22.0955 (Бид: $22.0940, Аск: $22.0990)
SUI: $2.6527 (Бид: $2.6522, Аск: $2.6528)
ARB: $0.3893 (Бид: $0.3891, Аск: $0.3894)
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`check_stats`)

#### Информация о конкретной позиции

```bash
python main.py -b bot_testnet -type info -p BTC
```

**Пример вывода:**
```
Ищу файл конфигурации по пути: C:\Users\Administrator\Desktop\crypro\hyper\data\bot_testnet.json
Информация о позиции: {'asset': 'BTC', 'size': 0.0011, 'entry_price': 87708.0, 'liquidation_price': None, 'leverage': 5, 'direction': 'long', 'unrealized_pnl': -0.0088, 'margin_used': 19.294, 'position_value': 96.47, 'return_on_equity': -0.0004560587}
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`info`)
- `-p` / `--pair`: Торговый актив

#### Проверка цены актива

```bash
python main.py -b bot_testnet -type price -p BTC
```

**Пример вывода:**
```
=== Рыночные данные для BTC ===
Текущая цена: $87655.5000
Бид (цена покупки): $87648.0000
Аск (цена продажи): $87663.0000
24ч Изменение: 0.00%
24ч Объем: $0.00
Открытый интерес: 0 BTC

=== Примерные ликвидационные цены при разном плече ===
Для длинной позиции (LONG):
  Плечо 1x: $17531.10
  Плечо 2x: $52593.30
  Плечо 5x: $73630.62
  Плечо 10x: $80643.06
  Плечо 20x: $84149.28
  Плечо 50x: $86253.01
  Плечо 100x: $86954.26

Для короткой позиции (SHORT):
  Плечо 1x: $157779.90
  Плечо 2x: $122717.70
  Плечо 5x: $101680.38
  Плечо 10x: $94667.94
  Плечо 20x: $91161.72
  Плечо 50x: $89057.99
  Плечо 100x: $88356.74
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`price`)
- `-p` / `--pair`: Торговый актив

### Управление позициями

#### Модификация позиции

```bash
python main.py -b bot_testnet -type modify -p ETH -s 2020 -t 2080
```

**Пример вывода:**
```
Ищу файл конфигурации по пути: C:\Users\Administrator\Desktop\crypro\hyper\data\bot_testnet.json
Позиция изменена: {'asset': 'ETH', 'leverage': None, 'stop_loss_id': 27070026994, 'take_profit_id': 27070027475}
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`modify`)
- `-p` / `--pair`: Торговый актив
- `-l` / `--leverage`: Новое значение плеча (опционально)
- `-s` / `--stop`: Новая цена стоп-лосс (опционально)
- `-t` / `--take_profit`: Новая цена тейк-профит (опционально)

#### Частичное закрытие позиций

##### Закрытие 25% позиции

```bash
python main.py -b bot_testnet -type close_position_25 -p BTC
```

##### Закрытие 50% позиции

```bash
python main.py -b bot_testnet -type close_position_50 -p BTC
```

**Пример вывода:**
```
Ищу файл конфигурации по пути: C:\Users\Administrator\Desktop\crypro\hyper\data\bot_testnet.json
Позиция 50% успешно закрыта: {'asset': 'BTC', 'size': 0.0006, 'price': 87634.5, 'leverage': 5.0, 'direction': 'short', 'stop_loss_id': None, 'take_profit_id': None, 'amount_usd': 48.230875}
Закрыто 0.00055 BTC (48.23 USD) из 0.0011 BTC
Оставшийся размер позиции: 0.00055 BTC (50%)
```

##### Закрытие 75% позиции

```bash
python main.py -b bot_testnet -type close_position_75 -p BTC
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`close_position_25`, `close_position_50`, `close_position_75`)
- `-p` / `--pair`: Торговый актив

### История торговли

```bash
python main.py -b bot_testnet -type history -p ETH -limit 3
```

**Пример вывода для успешного запроса:**
```
История торговли для актива ETH:
Время: 2023-06-15 08:14:22
Актив: ETH
Действие: buy
Размер: 0.4891 ETH
Цена: $2044.55
Комиссия: $0.0412
ID ордера: 27070021617
----------------------------------------
Время: 2023-06-15 08:15:46
Актив: ETH
Действие: sell
Размер: 0.4891 ETH
Цена: $2045.10
Комиссия: $0.0415
ID ордера: 27070027475
----------------------------------------
```

Параметры:
- `-b` / `--bot`: Имя конфигурационного файла бота
- `-type` / `--operation`: Тип операции (`history`)
- `-p` / `--pair`: Торговый актив (опционально, если не указан - вся история)
- `-limit` / `--limit`: Лимит записей (опционально, по умолчанию 10)

### Вывод в JSON формате

Добавьте флаг `-j` к любой команде для получения результата в JSON формате:

```bash
python main.py -b bot_testnet -type info -p ETH -j
```

**Пример вывода:**
```json
{
  "asset": "ETH",
  "size": 0.4891,
  "entry_price": 2044.55,
  "liquidation_price": null,
  "leverage": 5,
  "direction": "long",
  "unrealized_pnl": 0.2691,
  "margin_used": 100.12,
  "position_value": 1000.0,
  "return_on_equity": 0.00269
}
```

## Рабочие процессы и сценарии использования

### Сценарий 1: Открытие позиции и установка защитных ордеров

```bash
# Проверка текущей цены актива
python main.py -b bot_testnet -type price -p ETH

# Открытие длинной позиции с защитными ордерами
python main.py -b bot_testnet -type open -p ETH -a 100 -l 5 -d long -s 1900 -t 2200

# Проверка открытой позиции
python main.py -b bot_testnet -type info -p ETH
```

### Сценарий 2: Управление открытой позицией

```bash
# Проверка статистики аккаунта
python main.py -b bot_testnet -type check_stats

# Модификация стоп-лосса при движении цены
python main.py -b bot_testnet -type modify -p ETH -s 1950

# Частичное закрытие позиции (50%)
python main.py -b bot_testnet -type close_position_50 -p ETH

# Закрытие оставшейся части позиции по рынку
python main.py -b bot_testnet -type market_close -p ETH
```

### Сценарий 3: Масштабирование позиции (пирамидинг)

```bash
# Открытие начальной позиции
python main.py -b bot_testnet -type open -p BTC -a 100 -l 5 -d long

# Добавление к позиции (донабор)
python main.py -b bot_testnet -type open -p BTC -a 50 -l 5 -d long

# Частичное закрытие (фиксация прибыли)
python main.py -b bot_testnet -type close_position_25 -p BTC

# Модификация стоп-лосса для защиты прибыли
python main.py -b bot_testnet -type modify -p BTC -s <новая_цена>
```

## Особенности и ограничения

### Минимальный размер ордера

Hyperliquid имеет ограничение на минимальный размер ордера (обычно около $20). При частичном закрытии малых позиций может потребоваться увеличить процент закрытия или использовать полное закрытие.

**Пример ошибки:**
```
ОШИБКА: Размер закрываемой позиции (12.50 USD) меньше минимального ордера на Hyperliquid (20 USD).
Попробуйте увеличить процент закрытия или используйте 'market_close' для полного закрытия.
Минимальный процент для закрытия этой позиции: 40.0%
```

### Доступность активов на Hyperliquid

Не все активы одинаково хорошо поддерживаются в тестовой сети Hyperliquid. В наших тестах мы обнаружили, что:

- BTC и ETH имеют полную поддержку и стабильно работают
- AVAX, CAKE и некоторые другие активы могут показывать успешное открытие позиции, но позиция может не быть видна в статистике

Рекомендуется использовать основные активы (BTC, ETH) для наиболее надежной работы, особенно в тестовой сети.

### Особенности Hyperliquid

- Все контракты на Hyperliquid номинированы в USD
- При указании торгового инструмента используйте только базовый актив (ETH, BTC)
- Тестовая сеть Hyperliquid имеет ограниченный функционал и может иметь отличия от основной сети
- При изменении стоп-лосса или тейк-профита, если вы указываете только один из параметров, другой может быть сброшен

## Советы по оптимизации торговли

1. **Всегда проверяйте цену** перед открытием позиции с помощью команды `price`
2. **Используйте частичное закрытие** для фиксации прибыли при благоприятном движении рынка
3. **Устанавливайте стоп-лосс и тейк-профит** при открытии позиции для автоматического управления рисками
4. **Регулярно проверяйте статистику** командой `check_stats` для контроля общей картины
5. **Используйте маркет-ордера** (`market_close`) в условиях высокой волатильности для немедленного закрытия позиции
6. **При изменении параметров позиции** всегда указывайте все необходимые параметры одновременно (стоп-лосс и тейк-профит вместе)

## Устранение неполадок

### Позиция открыта, но не отображается в статистике

Это может происходить по следующим причинам:
1. Ограниченная поддержка актива в тестовой сети
2. Размер позиции слишком мал для отображения
3. Позиция была автоматически закрыта из-за несоответствия требованиям биржи

**Решение:** Попробуйте открыть позицию с большим размером (от 200$) и/или использовать основные активы (BTC, ETH).

### Ошибка "Минимальный размер ордера"

Если вы пытаетесь частично закрыть позицию и получаете ошибку о минимальном размере ордера:

**Решение:**
1. Увеличьте процент закрываемой позиции (например, используйте 75% вместо 25%)
2. Используйте `market_close` для полного закрытия позиции
3. Сначала увеличьте размер позиции, а затем попробуйте частично закрыть

## Развитие продукта

Hyperliquid Trading CLI постоянно совершенствуется. Текущие направления развития:
- Интеграция с торговыми сигналами и оповещениями
- Автоматизация стратегий с использованием технического анализа
- Создание графического интерфейса для упрощения использования
- Расширенная аналитика и визуализация торговых результатов
- Улучшенное управление ордерами с поддержкой трейлинг-стопов

## Заключение

Hyperliquid Trading CLI — это профессиональный инструмент для трейдеров, предоставляющий полный контроль над торговлей на бирже Hyperliquid. Простой и понятный интерфейс командной строки позволяет эффективно управлять позициями и автоматизировать торговые операции, открывая новые возможности как для ручного, так и для алгоритмического трейдинга. 

Хотя некоторые функции имеют ограничения, особенно в тестовой сети, основной функционал (открытие и закрытие позиций, частичное закрытие, модификация параметров) работает стабильно и эффективно для основных криптовалют. 
